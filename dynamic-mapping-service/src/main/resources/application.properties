#
# Copyright (c) 2022-2025 Cumulocity GmbH.
#
# SPDX-License-Identifier: Apache-2.0
#
#  Licensed under the Apache License, Version 2.0 (the "License");
#  you may not use this file except in compliance with the License.
#  You may obtain a copy of the License at
#
#       http://www.apache.org/licenses/LICENSE-2.0
#
#  Unless required by applicable law or agreed to in writing, software
#  distributed under the License is distributed on an "AS IS" BASIS,
#  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
#  See the License for the specific language governing permissions and
#  limitations under the License.
#
#  @authors Christof Strack, Stefan Witschel
#
#
spring.profiles.active=prod
spring.threads.virtual.enabled=true
application.name=dynamic-mapping-service
application.version=@project.version@
server.port=8080
server.error.include-message=always
APP.externalExtensionsEnabled=true

# ensure to leave this disabled, since the UI does not support this at the moment
APP.userRolesEnabled=false
APP.mappingAdminRole=ROLE_MAPPING_ADMIN
APP.mappingHttpConnectorRole=ROLE_MAPPING_HTTP_CONNECTOR_CREATE
APP.mappingCreateRole=ROLE_MAPPING_CREATE
APP.inboundExternalIdCacheSize=100000
APP.inventoryCacheSize=100000

# set to false to enable Open Telemetry Instrumentation
otel.sdk.disabled=true

APP.template.code.inbound_01=Ly8KLy8gc2FtcGxlIHRvIGdlbmVyYXRlIG9uZSBtZWFzdXJlbWVudAovLwoKLy8gcGF5bG9hZAovLyB7Ci8vICAgICAidGVtcGVyYXR1cmUiOiAxMzkuMCwKLy8gICAgICJ1bml0IjogIkMiLAovLyAgICAgImV4dGVybmFsSWQiOiAiYmVybGluXzAxIgovLyAgfQovLyB0b3BpYyAndGVzdEdyYWFsc1NpbmdsZS9iZXJsaW5fMDEnCgpmdW5jdGlvbiBleHRyYWN0RnJvbVNvdXJjZShjdHgpIHsKICAgIC8vVGhpcyBpcyB0aGUgc291cmNlIG1lc3NhZ2UgYXMganNvbgogICAgY29uc3Qgc291cmNlT2JqZWN0ID0gSlNPTi5wYXJzZShjdHguZ2V0UGF5bG9hZCgpKTsKCiAgICBmb3IgKHZhciBrZXkgaW4gc291cmNlT2JqZWN0KSB7CiAgICAgICAgY29uc29sZS5sb2coYGtleTogJHtrZXl9LCB2YWx1ZTogJHtzb3VyY2VPYmplY3Rba2V5XX1gKTsKICAgIH0KCiAgICAvLyBEZWZpbmUgYSBuZXcgTWVhc3VyZW1lbnQgVmFsdWUgZm9yIFRlbXBlcmF0dXJlcyBieSBhc3NpZ25pbmcgZnJvbSBzb3VyY2UKICAgIGNvbnN0IGZyYWdtZW50VGVtcGVyYXR1cmVTZXJpZXMgPSB7CiAgICAgICAgdmFsdWU6IHNvdXJjZU9iamVjdFsndGVtcGVyYXR1cmUnXSwKICAgICAgICB1bml0OiBzb3VyY2VPYmplY3RbJ3VuaXQnXQogICAgfTsKCiAgICAvLyBBc3NpZ24gVmFsdWVzIHRvIFNlcmllcwogICAgY29uc3QgZnJhZ21lbnRUZW1wZXJhdHVyZSA9IHsKICAgICAgICBUOiBmcmFnbWVudFRlbXBlcmF0dXJlU2VyaWVzCiAgICB9OwoKICAgIC8vIENyZWF0ZSBhIG5ldyBTdWJzdGl0dXRpb25SZXN1bHQgd2l0aCB0aGUgSGFzaE1hcAogICAgY29uc3QgcmVzdWx0ID0gbmV3IFN1YnN0aXR1dGlvblJlc3VsdCgpOwoKICAgIC8vIEFkZCB0aW1lIHdpdGgga2V5ICd0aW1lJyB0byByZXN1bHQuZ2V0U3Vic3RpdHV0aW9ucygpCiAgICAvLyBjb25zdCB0aW1lID0gbmV3IFN1YnN0aXR1dGlvblZhbHVlKHNvdXJjZU9iamVjdFsndGltZSddLCAnVEVYVFVBTCcsICdERUZBVUxUJywgZmFsc2UpOwogICAgLy8gYWRkVG9TdWJzdGl0dXRpb25zTWFwKHJlc3VsdCwgJ3RpbWUnLCB0aW1lKTsKCiAgICAvLyBEZWZpbmUgdGVtcGVyYXR1cmUgZnJhZ21lbnQgbWFwcGluZyB0ZW1wZXJhdHVyZSAtPiBjOHlfVGVtcGVyYXR1cmUuVC52YWx1ZS91bml0CiAgICBjb25zdCB0ZW1wZXJhdHVyZSA9IG5ldyBTdWJzdGl0dXRpb25WYWx1ZShmcmFnbWVudFRlbXBlcmF0dXJlLCBUWVBFLk9CSkVDVCwgUmVwYWlyU3RyYXRlZ3kuREVGQVVMVCwgZmFsc2UpOwogICAgLy8gQWRkIHRlbXBlcmF0dXJlIHdpdGgga2V5ICdjOHlfVGVtcGVyYXR1cmVNZWFzdXJlbWVudCcgdG8gcmVzdWx0LmdldFN1YnN0aXR1dGlvbnMoKQogICAgYWRkVG9TdWJzdGl0dXRpb25zTWFwKHJlc3VsdCwgJ2M4eV9UZW1wZXJhdHVyZU1lYXN1cmVtZW50JywgdGVtcGVyYXR1cmUpOwoKICAgIC8vIERlZmluZSBEZXZpY2UgSWRlbnRpZmllcgogICAgY29uc3QgZGV2aWNlSWRlbnRpZmllciA9IG5ldyBTdWJzdGl0dXRpb25WYWx1ZShzb3VyY2VPYmplY3RbJ19UT1BJQ19MRVZFTF8nXVsxXSwgVFlQRS5URVhUVUFMLCBSZXBhaXJTdHJhdGVneS5ERUZBVUxULCBmYWxzZSk7CiAgICAvLyBBZGQgZGV2aWNlSWRlbnRpZmllciB3aXRoIGtleSBjdHguZ2V0R2VuZXJpY0RldmljZUlkZW50aWZpZXIoKSB0byByZXN1bHQuZ2V0U3Vic3RpdHV0aW9ucygpCiAgICBhZGRUb1N1YnN0aXR1dGlvbnNNYXAocmVzdWx0LCBjdHguZ2V0R2VuZXJpY0RldmljZUlkZW50aWZpZXIoKSwgZGV2aWNlSWRlbnRpZmllcik7CgogICAgcmV0dXJuIHJlc3VsdDsKfQo=

APP.template.code.inbound_02=Ly8KLy8gc2FtcGxlIHRvIGdlbmVyYXRlIG11bHRpcGxlIG1lYXN1cmVtZW50cwovLwoKLy8gcGF5bG9hZAovLyB7Ci8vICAgICAidGVtcGVyYXR1cmUiOiBbMTM5LjAsIDE1MC4wXSwKLy8gICAgICJleHRlcm5hbElkIjogImJlcmxpbl8wMSIKLy8gIH0KLy8gdG9waWMgJ3Rlc3RHcmFhbHNNdWx0aS9iZXJsaW5fMDEnCgpmdW5jdGlvbiBleHRyYWN0RnJvbVNvdXJjZShjdHgpIHsKCiAgICAvL1RoaXMgaXMgdGhlIHNvdXJjZSBtZXNzYWdlIGFzIGpzb24KICAgIGNvbnN0IHNvdXJjZU9iamVjdCA9IEpTT04ucGFyc2UoY3R4LmdldFBheWxvYWQoKSk7CiAgICAvLyBmb3IgKHZhciBrZXkgaW4gc291cmNlT2JqZWN0KSB7CiAgICAvLyAgICAgY29uc29sZS5sb2coYGtleTogJHtrZXl9LCB2YWx1ZTogJHtzb3VyY2VPYmplY3Rba2V5XX1gKTsgIAogICAgLy8gfQogICAgY29uc3QgdGVtcEFycmF5ID0gc291cmNlT2JqZWN0Wyd0ZW1wZXJhdHVyZSddOwoKICAgIC8vIENyZWF0ZSBhIG5ldyBTdWJzdGl0dXRpb25SZXN1bHQgd2l0aCB0aGUgSGFzaE1hcHMKICAgIGNvbnN0IHJlc3VsdCA9IG5ldyBTdWJzdGl0dXRpb25SZXN1bHQoKTsKCiAgICAvLyBMb29wIHRocm91Z2ggYWxsIHRlbXBlcmF0dXJlIGFycmF5IGVudHJpZXMKICAgIGNvbnN0IHNpemUgPSB0ZW1wQXJyYXkuc2l6ZSgpOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaXplOyBpKyspIHsKICAgICAgICBjb25zdCB0ZW1wZXJhdHVyZVZhbHVlID0gbmV3IFN1YnN0aXR1dGlvblZhbHVlKAogICAgICAgICAgICB0ZW1wQXJyYXkuZ2V0KGkpLAogICAgICAgICAgICBUWVBFLk5VTUJFUiwKICAgICAgICAgICAgUmVwYWlyU3RyYXRlZ3kuREVGQVVMVCwKICAgICAgICAgICAgdHJ1ZQogICAgICAgICk7CiAgICAgICAgYWRkVG9TdWJzdGl0dXRpb25zTWFwKHJlc3VsdCwgJ2M4eV9UZW1wZXJhdHVyZU1lYXN1cmVtZW50LlQudmFsdWUnLCB0ZW1wZXJhdHVyZVZhbHVlKTsKICAgIH0KCiAgICAvL0RlZmluZSBEZXZpY2UgSWRlbnRpZmllcgogICAgY29uc3QgZGV2aWNlSWRlbnRpZmllciA9IG5ldyBTdWJzdGl0dXRpb25WYWx1ZShzb3VyY2VPYmplY3RbJ19UT1BJQ19MRVZFTF8nXVsxXSwgVFlQRS5URVhUVUFMLCBSZXBhaXJTdHJhdGVneS5ERUZBVUxULCBmYWxzZSk7CiAgICBhZGRUb1N1YnN0aXR1dGlvbnNNYXAocmVzdWx0LCBjdHguZ2V0R2VuZXJpY0RldmljZUlkZW50aWZpZXIoKSwgZGV2aWNlSWRlbnRpZmllcik7CgogICAgcmV0dXJuIHJlc3VsdDsKfQ==

APP.template.code.outbound_01=ZnVuY3Rpb24gZXh0cmFjdEZyb21Tb3VyY2UoY3R4KSB7CiAgICAvL1RoaXMgaXMgdGhlIHNvdXJjZSBtZXNzYWdlIGFzIGpzb24KICAgIGNvbnN0IHNvdXJjZU9iamVjdCA9IEpTT04ucGFyc2UoY3R4LmdldFBheWxvYWQoKSk7CgogICAgLy9Mb2cgYzh5IHNvdXJjZUlkCiAgICAvL2NvbnNvbGUubG9nKGBDOFkgc291cmNlSWQ6ICR7Y3R4LmdldEM4WUlkZW50aWZpZXIoKX1gKTsKICAgIC8vY29uc29sZS5sb2coYEM4WSBleHRlcm5hbElkZW50aWZpZXI6ICR7Y3R4LmdldEV4dGVybmFsSWRlbnRpZmllcigpfWApOwoKICAgIC8vZm9yICh2YXIga2V5IGluIHNvdXJjZU9iamVjdCkgewogICAgLy8gICAgIGNvbnNvbGUubG9nKGBrZXk6ICR7a2V5fSwgdmFsdWU6ICR7c291cmNlT2JqZWN0W2tleV19YCk7ICAKICAgIC8vIH0KCiAgICAvL0RlZmluZSBhIG5ldyBNZWFzdXJlbWVudCBWYWx1ZSBmb3IgVGVtcGVyYXR1cmVzIGJ5IGFzc2lnbmluZyBmcm9tIHNvdXJjZQogICAgY29uc3QgZnJhZ21lbnRUZW1wZXJhdHVyZSA9IHsKICAgICAgICB2YWx1ZTogc291cmNlT2JqZWN0WydjOHlfVGVtcGVyYXR1cmVNZWFzdXJlbWVudCddWydUJ11bJ3ZhbHVlJ10sCiAgICAgICAgdW5pdDogc291cmNlT2JqZWN0WydjOHlfVGVtcGVyYXR1cmVNZWFzdXJlbWVudCddWydUJ11bJ3VuaXQnXQogICAgfTsKCiAgICAvLyBDcmVhdGUgYSBuZXcgU3Vic3RpdHV0aW9uUmVzdWx0IHdpdGggdGhlIEhhc2hNYXAKICAgIGNvbnN0IHJlc3VsdCA9IG5ldyBTdWJzdGl0dXRpb25SZXN1bHQoKTsKCiAgICAvLyBTdWJzdGl0dXRpb246IFN0cmluZyBrZXksIE9iamVjdCB2YWx1ZSwgTWFwcGluZ1N1YnN0aXR1dGlvbi5TdWJzdGl0dXRlVmFsdWUuVFlQRSB0eXBlLCBSZXBhaXJTdHJhdGVneSByZXBhaXJTdHJhdGVneQogICAgLy9EZWZpbmUgdGltZSBtYXBwaW5nIHRpbWUgLT4gdGltZQogICAgY29uc3QgdGltZSA9IG5ldyBTdWJzdGl0dXRpb25WYWx1ZShzb3VyY2VPYmplY3RbJ3RpbWUnXSwgVFlQRS5URVhUVUFMLCBSZXBhaXJTdHJhdGVneS5ERUZBVUxULCBmYWxzZSk7CiAgICBhZGRUb1N1YnN0aXR1dGlvbnNNYXAocmVzdWx0LCAndGltZScsIHRpbWUpOwoKICAgIC8vRGVmaW5lIHRlbXBlcmF0dXJlIGZyYWdtZW50IG1hcHBpbmcgdGVtcGVyYXR1cmUgLT4gYzh5X1RlbXBlcmF0dXJlLlQudmFsdWUvdW5pdAogICAgY29uc3QgdGVtcGVyYXR1cmUgPSBuZXcgU3Vic3RpdHV0aW9uVmFsdWUoZnJhZ21lbnRUZW1wZXJhdHVyZSwgVFlQRS5PQkpFQ1QsIFJlcGFpclN0cmF0ZWd5LkRFRkFVTFQsIGZhbHNlKTsKICAgIGFkZFRvU3Vic3RpdHV0aW9uc01hcChyZXN1bHQsICdUZW1wZXJhdHVyZScsIHRlbXBlcmF0dXJlKTsKCiAgICAvL0RlZmluZSBEZXZpY2UgSWRlbnRpZmllcgogICAgY29uc3QgZGV2aWNlSWRlbnRpZmllciA9IG5ldyBTdWJzdGl0dXRpb25WYWx1ZShjdHguZ2V0RXh0ZXJuYWxJZGVudGlmaWVyKCksIFRZUEUuVEVYVFVBTCwgUmVwYWlyU3RyYXRlZ3kuREVGQVVMVCwgZmFsc2UpOwogICAgYWRkVG9TdWJzdGl0dXRpb25zTWFwKHJlc3VsdCwgJ19UT1BJQ19MRVZFTF9bMV0nLCBkZXZpY2VJZGVudGlmaWVyKTsKCiAgICAvL1VzZSBDOFkgc291cmNlSWQKICAgIGNvbnN0IGRldmljZUlkID0gbmV3IFN1YnN0aXR1dGlvblZhbHVlKGN0eC5nZXRDOFlJZGVudGlmaWVyKCksIFRZUEUuVEVYVFVBTCwgUmVwYWlyU3RyYXRlZ3kuREVGQVVMVCwgZmFsc2UpOwogICAgYWRkVG9TdWJzdGl0dXRpb25zTWFwKHJlc3VsdCwgJ2RldmljZUlkJywgZGV2aWNlSWQpOwoKICAgIHJldHVybiByZXN1bHQ7Cn0=

APP.template.code.outbound_02=ZnVuY3Rpb24gZXh0cmFjdEZyb21Tb3VyY2UoY3R4KSB7CiAgICAvL1RoaXMgaXMgdGhlIHNvdXJjZSBtZXNzYWdlIGFzIGpzb24KICAgIGNvbnN0IHNvdXJjZU9iamVjdCA9IEpTT04ucGFyc2UoY3R4LmdldFBheWxvYWQoKSk7CgogICAgLy8gQ3JlYXRlIGEgbmV3IFN1YnN0aXR1dGlvblJlc3VsdCB3aXRoIHRoZSBIYXNoTWFwCiAgICBjb25zdCByZXN1bHQgPSBuZXcgU3Vic3RpdHV0aW9uUmVzdWx0KCk7CgogICAgLy9EZWZpbmUgYSBuZXcgTWVhc3VyZW1lbnQgVmFsdWUgZm9yIFRlbXBlcmF0dXJlcyBieSBhc3NpZ25pbmcgZnJvbSBzb3VyY2UKICAgIGNvbnN0IGZyYWdtZW50VGVtcGVyYXR1cmUgPSB7CiAgICAgICAgdmFsdWU6IHNvdXJjZU9iamVjdFsnYzh5X1RlbXBlcmF0dXJlTWVhc3VyZW1lbnQnXVsnVCddWyd2YWx1ZSddLAogICAgICAgIHVuaXQ6IHNvdXJjZU9iamVjdFsnYzh5X1RlbXBlcmF0dXJlTWVhc3VyZW1lbnQnXVsnVCddWyd1bml0J10KICAgIH07CgogICAgLy8gU3Vic3RpdHV0aW9uVmFsdWU6IFN0cmluZyBrZXksIE9iamVjdCB2YWx1ZSwgU3Vic3RpdHV0ZVZhbHVlLlRZUEUgdHlwZSwgUmVwYWlyU3RyYXRlZ3kgcmVwYWlyU3RyYXRlZ3kKICAgIC8vRGVmaW5lIHRpbWUgbWFwcGluZyB0aW1lIC0+IHRpbWUKICAgIGNvbnN0IHRpbWUgPSBuZXcgU3Vic3RpdHV0aW9uVmFsdWUoc291cmNlT2JqZWN0Wyd0aW1lJ10sIFRZUEUuVEVYVFVBTCwgUmVwYWlyU3RyYXRlZ3kuREVGQVVMVCwgZmFsc2UpOwogICAgYWRkVG9TdWJzdGl0dXRpb25zTWFwKHJlc3VsdCwgJ3RpbWUnLCB0aW1lKTsKCiAgICAvL0RlZmluZSB0ZW1wZXJhdHVyZSBmcmFnbWVudCBtYXBwaW5nIHRlbXBlcmF0dXJlIC0+IGM4eV9UZW1wZXJhdHVyZS5ULnZhbHVlL3VuaXQKICAgIGNvbnN0IHRlbXBlcmF0dXJlID0gbmV3IFN1YnN0aXR1dGlvblZhbHVlKGZyYWdtZW50VGVtcGVyYXR1cmUsIFRZUEUuT0JKRUNULCBSZXBhaXJTdHJhdGVneS5ERUZBVUxULCBmYWxzZSk7CiAgICBhZGRUb1N1YnN0aXR1dGlvbnNNYXAocmVzdWx0LCAnVGVtcGVyYXR1cmUnLCB0ZW1wZXJhdHVyZSk7CgogICAgLy9Vc2UgQzhZIHNvdXJjZUlkCiAgICBjb25zdCBkZXZpY2VJZCA9IG5ldyBTdWJzdGl0dXRpb25WYWx1ZShjdHguZ2V0QzhZSWRlbnRpZmllcigpLCBUWVBFLlRFWFRVQUwsIFJlcGFpclN0cmF0ZWd5LkRFRkFVTFQsIGZhbHNlKTsKICAgIC8vIGFkZFRvU3Vic3RpdHV0aW9uc01hcChyZXN1bHQsICdkZXZpY2VJZCcsIGRldmljZUlkKTsKCiAgICBjb25zdCBzb3VyY2UgPSB7CiAgICAgICAgaWQ6IGN0eC5nZXRDOFlJZGVudGlmaWVyKCkKICAgIH07CiAgICBjb25zdCBzb3VyY2VGcmFnbWVudCA9IG5ldyBTdWJzdGl0dXRpb25WYWx1ZShzb3VyY2UsIFRZUEUuT0JKRUNULCBSZXBhaXJTdHJhdGVneS5DUkVBVEVfSUZfTUlTU0lORywgZmFsc2UpOwogICAgYWRkVG9TdWJzdGl0dXRpb25zTWFwKHJlc3VsdCwgJ3NvdXJjZScsIHNvdXJjZUZyYWdtZW50KTsKCiAgICByZXR1cm4gcmVzdWx0Owp9

APP.template.code.system=Y29uc3QgU3Vic3RpdHV0aW9uUmVzdWx0ID0gSmF2YS50eXBlKCdkeW5hbWljLm1hcHBpbmcucHJvY2Vzc29yLm1vZGVsLlN1YnN0aXR1dGlvblJlc3VsdCcpOwpjb25zdCBTdWJzdGl0dXRpb25WYWx1ZSA9IEphdmEudHlwZSgnZHluYW1pYy5tYXBwaW5nLnByb2Nlc3Nvci5tb2RlbC5TdWJzdGl0dXRlVmFsdWUnKTsKY29uc3QgQXJyYXlMaXN0ID0gSmF2YS50eXBlKCdqYXZhLnV0aWwuQXJyYXlMaXN0Jyk7CmNvbnN0IEhhc2hNYXAgPSBKYXZhLnR5cGUoJ2phdmEudXRpbC5IYXNoTWFwJyk7CmNvbnN0IFRZUEUgPSBKYXZhLnR5cGUoJ2R5bmFtaWMubWFwcGluZy5wcm9jZXNzb3IubW9kZWwuU3Vic3RpdHV0ZVZhbHVlJFRZUEUnKTsKY29uc3QgUmVwYWlyU3RyYXRlZ3kgPSBKYXZhLnR5cGUoJ2R5bmFtaWMubWFwcGluZy5wcm9jZXNzb3IubW9kZWwuUmVwYWlyU3RyYXRlZ3knKTsKCi8vIEhlbHBlciBmdW5jdGlvbiB0byBhZGQgYSBTdWJzdGl0dXRpb25WYWx1ZSB0byB0aGUgbWFwCmZ1bmN0aW9uIGFkZFRvU3Vic3RpdHV0aW9uc01hcChyZXN1bHQsIGtleSwgdmFsdWUpIHsKICAgIGxldCBtYXAgPSByZXN1bHQuZ2V0U3Vic3RpdHV0aW9ucygpOwogICAgbGV0IHZhbHVlc0xpc3QgPSBtYXAuZ2V0KGtleSk7CgogICAgLy8gSWYgdGhlIGxpc3QgZG9lc24ndCBleGlzdCBmb3IgdGhpcyBrZXksIGNyZWF0ZSBpdAogICAgaWYgKHZhbHVlc0xpc3QgPT09IG51bGwgfHwgdmFsdWVzTGlzdCA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgdmFsdWVzTGlzdCA9IG5ldyBBcnJheUxpc3QoKTsKICAgICAgICBtYXAucHV0KGtleSwgdmFsdWVzTGlzdCk7CiAgICB9CgogICAgLy8gQWRkIHRoZSB2YWx1ZSB0byB0aGUgbGlzdAogICAgdmFsdWVzTGlzdC5hZGQodmFsdWUpOwp9

APP.template.code.shared=Ly8gYWRkIHlvdXIgc2hhcmVkIGNvZGUgcmVsZXZhbnQgZm9yIGFsbCBtYXBwaW5ncyBoZXJlIC4uLg==
