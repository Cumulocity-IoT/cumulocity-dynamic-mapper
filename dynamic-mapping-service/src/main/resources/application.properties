#
# Copyright (c) 2022-2025 Cumulocity GmbH.
#
# SPDX-License-Identifier: Apache-2.0
#
#  Licensed under the Apache License, Version 2.0 (the "License");
#  you may not use this file except in compliance with the License.
#  You may obtain a copy of the License at
#
#       http://www.apache.org/licenses/LICENSE-2.0
#
#  Unless required by applicable law or agreed to in writing, software
#  distributed under the License is distributed on an "AS IS" BASIS,
#  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
#  See the License for the specific language governing permissions and
#  limitations under the License.
#
#  @authors Christof Strack, Stefan Witschel
#
#
spring.profiles.active=prod
spring.threads.virtual.enabled=true
application.name=dynamic-mapping-service
application.version=@project.version@
server.port=8080
server.error.include-message=always
APP.externalExtensionsEnabled=true
# ensure to leave this disabled, since the UI does not support this at the moment
APP.userRolesEnabled=false
APP.mappingAdminRole=ROLE_MAPPING_ADMIN
APP.mappingHttpConnectorRole=ROLE_MAPPING_HTTP_CONNECTOR_CREATE
APP.mappingCreateRole=ROLE_MAPPING_CREATE
APP.inboundExternalIdCacheSize=100000
# set to false to enable Open Telemetry Instrumentation
otel.sdk.disabled=true

APP.template.code.inbound_01=Ly8KLy8gc2FtcGxlIHRvIGdlbmVyYXRlIG9uZSBtZWFzdXJlbWVudAovLwoKLy8gcGF5bG9hZAovLyB7Ci8vICAgICAidGVtcGVyYXR1cmUiOiAxMzkuMCwKLy8gICAgICJ1bml0IjogIkMiLAovLyAgICAgImV4dGVybmFsSWQiOiAiYmVybGluXzAxIgovLyAgfQovLyB0b3BpYyAndGVzdEdyYWFsc1NpbmdsZS9iZXJsaW5fMDEnCgpmdW5jdGlvbiBleHRyYWN0RnJvbVNvdXJjZShjdHgpIHsKICAgIC8vIFRoaXMgaXMgdGhlIHNvdXJjZSBtZXNzYWdlIGFzIGpzb24KICAgIGNvbnN0IHNvdXJjZU9iamVjdCA9IGN0eC5nZXRKc29uT2JqZWN0KCk7CiAgICBmb3IgKHZhciBrZXkgaW4gc291cmNlT2JqZWN0KSB7CiAgICAgICAgY29uc29sZS5sb2coYGtleTogJHtrZXl9LCB2YWx1ZTogJHtzb3VyY2VPYmplY3QuZ2V0KGtleSl9YCk7CiAgICB9CgogICAgLy8gRGVmaW5lIGEgbmV3IE1lYXN1cmVtZW50IFZhbHVlIGZvciBUZW1wZXJhdHVyZXMgYnkgYXNzaWduaW5nIGZyb20gc291cmNlCiAgICBjb25zdCBmcmFnbWVudFRlbXBlcmF0dXJlU2VyaWVzID0gewogICAgICAgIHZhbHVlOiBzb3VyY2VPYmplY3QuZ2V0KCd0ZW1wZXJhdHVyZScpLAogICAgICAgIHVuaXQ6IHNvdXJjZU9iamVjdC5nZXQoJ3VuaXQnKQogICAgfTsKCiAgICAvLyBBc3NpZ24gVmFsdWVzIHRvIFNlcmllcwogICAgY29uc3QgZnJhZ21lbnRUZW1wZXJhdHVyZSA9IHsKICAgICAgICBUOiBmcmFnbWVudFRlbXBlcmF0dXJlU2VyaWVzCiAgICB9OwoKICAgIC8vIENyZWF0ZSBhIG5ldyBTdWJzdGl0dXRpb25SZXN1bHQgd2l0aCB0aGUgSGFzaE1hcAogICAgY29uc3QgcmVzdWx0ID0gbmV3IFN1YnN0aXR1dGlvblJlc3VsdCgpOwoKICAgIC8vIEFkZCB0aW1lIHdpdGgga2V5ICd0aW1lJyB0byByZXN1bHQuZ2V0U3Vic3RpdHV0aW9ucygpCiAgICAvLyBjb25zdCB0aW1lID0gbmV3IFN1YnN0aXR1dGlvblZhbHVlKHNvdXJjZU9iamVjdC5nZXQoJ3RpbWUnKSwgJ1RFWFRVQUwnLCAnREVGQVVMVCcsIGZhbHNlKTsKICAgIC8vIGFkZFRvU3Vic3RpdHV0aW9uc01hcChyZXN1bHQsICd0aW1lJywgdGltZSk7CgogICAgLy8gRGVmaW5lIHRlbXBlcmF0dXJlIGZyYWdtZW50IG1hcHBpbmcgdGVtcGVyYXR1cmUgLT4gYzh5X1RlbXBlcmF0dXJlLlQudmFsdWUvdW5pdAogICAgY29uc3QgdGVtcGVyYXR1cmUgPSBuZXcgU3Vic3RpdHV0aW9uVmFsdWUoZnJhZ21lbnRUZW1wZXJhdHVyZSxUWVBFLk9CSkVDVCwgUmVwYWlyU3RyYXRlZ3kuREVGQVVMVCwgZmFsc2UpOwogICAgLy8gQWRkIHRlbXBlcmF0dXJlIHdpdGgga2V5ICdjOHlfVGVtcGVyYXR1cmVNZWFzdXJlbWVudCcgdG8gcmVzdWx0LmdldFN1YnN0aXR1dGlvbnMoKQogICAgYWRkVG9TdWJzdGl0dXRpb25zTWFwKHJlc3VsdCwgJ2M4eV9UZW1wZXJhdHVyZU1lYXN1cmVtZW50JywgdGVtcGVyYXR1cmUpOwoKICAgIC8vIERlZmluZSBEZXZpY2UgSWRlbnRpZmllcgogICAgY29uc3QgZGV2aWNlSWRlbnRpZmllciA9IG5ldyBTdWJzdGl0dXRpb25WYWx1ZShzb3VyY2VPYmplY3QuZ2V0KCdfVE9QSUNfTEVWRUxfJylbMV0sIFRZUEUuVEVYVFVBTCxSZXBhaXJTdHJhdGVneS5ERUZBVUxULCBmYWxzZSk7CiAgICAvLyBBZGQgZGV2aWNlSWRlbnRpZmllciB3aXRoIGtleSBjdHguZ2V0R2VuZXJpY0RldmljZUlkZW50aWZpZXIoKSB0byByZXN1bHQuZ2V0U3Vic3RpdHV0aW9ucygpCiAgICBhZGRUb1N1YnN0aXR1dGlvbnNNYXAocmVzdWx0LCBjdHguZ2V0R2VuZXJpY0RldmljZUlkZW50aWZpZXIoKSwgZGV2aWNlSWRlbnRpZmllcik7CgogICAgcmV0dXJuIHJlc3VsdDsKfQo=

APP.template.code.inbound_02=Ly8KLy8gc2FtcGxlIHRvIGdlbmVyYXRlIG11bHRpcGxlIG1lYXN1cmVtZW50cwovLwoKLy8gcGF5bG9hZAovLyB7Ci8vICAgICAidGVtcGVyYXR1cmUiOiBbMTM5LjAsIDE1MC4wXSwKLy8gICAgICJleHRlcm5hbElkIjogImJlcmxpbl8wMSIKLy8gIH0KLy8gdG9waWMgJ3Rlc3RHcmFhbHNNdWx0aS9iZXJsaW5fMDEnCgpmdW5jdGlvbiBleHRyYWN0RnJvbVNvdXJjZShjdHgpIHsKCiAgICAvL1RoaXMgaXMgdGhlIHNvdXJjZSBtZXNzYWdlIGFzIGpzb24KICAgIGNvbnN0IHNvdXJjZU9iamVjdCA9IGN0eC5nZXRKc29uT2JqZWN0KCk7CiAgICAvLyBmb3IgKHZhciBrZXkgaW4gc291cmNlT2JqZWN0KSB7CiAgICAvLyAgICAgY29uc29sZS5sb2coYGtleTogJHtrZXl9LCB2YWx1ZTogJHtzb3VyY2VPYmplY3QuZ2V0KGtleSl9YCk7ICAKICAgIC8vIH0KICAgIGNvbnN0IHRlbXBBcnJheSA9IHNvdXJjZU9iamVjdC5nZXQoJ3RlbXBlcmF0dXJlJyk7CgogICAgLy8gQ3JlYXRlIGEgbmV3IFN1YnN0aXR1dGlvblJlc3VsdCB3aXRoIHRoZSBIYXNoTWFwCiAgICBjb25zdCByZXN1bHQgPSBuZXcgU3Vic3RpdHV0aW9uUmVzdWx0KCk7CgogICAgLy8gTG9vcCB0aHJvdWdoIGFsbCB0ZW1wZXJhdHVyZSBhcnJheSBlbnRyaWVzCiAgICBjb25zdCBzaXplID0gdGVtcEFycmF5LnNpemUoKTsgCiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNpemU7IGkrKykgewogICAgICAgIGNvbnN0IHRlbXBlcmF0dXJlVmFsdWUgPSBuZXcgU3Vic3RpdHV0aW9uVmFsdWUoCiAgICAgICAgICAgIHRlbXBBcnJheS5nZXQoaSksIAogICAgICAgICAgICBUWVBFLk5VTUJFUiwgCiAgICAgICAgICAgIFJlcGFpclN0cmF0ZWd5LkRFRkFVTFQsIAogICAgICAgICAgICB0cnVlCiAgICAgICAgKTsKICAgICAgICBhZGRUb1N1YnN0aXR1dGlvbnNNYXAocmVzdWx0LCAnYzh5X1RlbXBlcmF0dXJlTWVhc3VyZW1lbnQuVC52YWx1ZScsIHRlbXBlcmF0dXJlVmFsdWUpOwogICAgfQoKICAgIC8vRGVmaW5lIERldmljZSBJZGVudGlmaWVyCiAgICBjb25zdCBkZXZpY2VJZGVudGlmaWVyID0gbmV3IFN1YnN0aXR1dGlvblZhbHVlKHNvdXJjZU9iamVjdC5nZXQoJ19UT1BJQ19MRVZFTF8nKVsxXSwgVFlQRS5URVhUVUFMLCBSZXBhaXJTdHJhdGVneS5ERUZBVUxULCBmYWxzZSk7CiAgICBhZGRUb1N1YnN0aXR1dGlvbnNNYXAocmVzdWx0LCBjdHguZ2V0R2VuZXJpY0RldmljZUlkZW50aWZpZXIoKSwgZGV2aWNlSWRlbnRpZmllcik7CgogICAgcmV0dXJuIHJlc3VsdDsKfQ==

APP.template.code.outbound_01=ZnVuY3Rpb24gZXh0cmFjdEZyb21Tb3VyY2UoY3R4KSB7CiAgICAvL1RoaXMgaXMgdGhlIHNvdXJjZSBtZXNzYWdlIGFzIGpzb24KICAgIGNvbnN0IHNvdXJjZU9iamVjdCA9IGN0eC5nZXRKc29uT2JqZWN0KCk7CgogICAgLy9Mb2cgYzh5IHNvdXJjZUlkCiAgICAvL2NvbnNvbGUubG9nKGBDOFkgc291cmNlSWQ6ICR7Y3R4LmdldEM4WUlkZW50aWZpZXIoKX1gKTsKICAgIC8vY29uc29sZS5sb2coYEM4WSBleHRlcm5hbElkZW50aWZpZXI6ICR7Y3R4LmdldEV4dGVybmFsSWRlbnRpZmllcigpfWApOwoKICAgIC8vZm9yICh2YXIga2V5IGluIHNvdXJjZU9iamVjdCkgewogICAgLy8gICAgIGNvbnNvbGUubG9nKGBrZXk6ICR7a2V5fSwgdmFsdWU6ICR7c291cmNlT2JqZWN0LmdldChrZXkpfWApOyAgCiAgICAvLyB9CgogICAgLy9EZWZpbmUgYSBuZXcgTWVhc3VyZW1lbnQgVmFsdWUgZm9yIFRlbXBlcmF0dXJlcyBieSBhc3NpZ25pbmcgZnJvbSBzb3VyY2UKICAgIGNvbnN0IGZyYWdtZW50VGVtcGVyYXR1cmUgPSB7CiAgICAgICAgdmFsdWU6IHNvdXJjZU9iamVjdC5nZXQoJ2M4eV9UZW1wZXJhdHVyZU1lYXN1cmVtZW50JykuZ2V0KCdUJykuZ2V0KCd2YWx1ZScpLAogICAgICAgIHVuaXQ6IHNvdXJjZU9iamVjdC5nZXQoJ2M4eV9UZW1wZXJhdHVyZU1lYXN1cmVtZW50JykuZ2V0KCdUJykuZ2V0KCd1bml0JykKICAgIH07CgogICAgLy8gQ3JlYXRlIGEgbmV3IFN1YnN0aXR1dGlvblJlc3VsdCB3aXRoIHRoZSBIYXNoTWFwCiAgICBjb25zdCByZXN1bHQgPSBuZXcgU3Vic3RpdHV0aW9uUmVzdWx0KCk7CgogICAgLy8gU3Vic3RpdHV0aW9uOiBTdHJpbmcga2V5LCBPYmplY3QgdmFsdWUsIE1hcHBpbmdTdWJzdGl0dXRpb24uU3Vic3RpdHV0ZVZhbHVlLlRZUEUgdHlwZSwgUmVwYWlyU3RyYXRlZ3kgcmVwYWlyU3RyYXRlZ3kKICAgIC8vRGVmaW5lIHRpbWUgbWFwcGluZyB0aW1lIC0+IHRpbWUKICAgIGNvbnN0IHRpbWUgPSBuZXcgU3Vic3RpdHV0aW9uVmFsdWUoc291cmNlT2JqZWN0LmdldCgndGltZScpLCBUWVBFLlRFWFRVQUwsIFJlcGFpclN0cmF0ZWd5LkRFRkFVTFQsIGZhbHNlKTsKICAgIGFkZFRvU3Vic3RpdHV0aW9uc01hcChyZXN1bHQsICd0aW1lJywgdGltZSk7CgogICAgLy9EZWZpbmUgdGVtcGVyYXR1cmUgZnJhZ21lbnQgbWFwcGluZyB0ZW1wZXJhdHVyZSAtPiBjOHlfVGVtcGVyYXR1cmUuVC52YWx1ZS91bml0CiAgICBjb25zdCB0ZW1wZXJhdHVyZSA9IG5ldyBTdWJzdGl0dXRpb25WYWx1ZShmcmFnbWVudFRlbXBlcmF0dXJlLCBUWVBFLk9CSkVDVCwgUmVwYWlyU3RyYXRlZ3kuREVGQVVMVCwgZmFsc2UpOwogICAgYWRkVG9TdWJzdGl0dXRpb25zTWFwKHJlc3VsdCwgJ1RlbXBlcmF0dXJlJywgdGVtcGVyYXR1cmUpOwoKICAgIC8vRGVmaW5lIERldmljZSBJZGVudGlmaWVyCiAgICBjb25zdCBkZXZpY2VJZGVudGlmaWVyID0gbmV3IFN1YnN0aXR1dGlvblZhbHVlKGN0eC5nZXRFeHRlcm5hbElkZW50aWZpZXIoKSwgVFlQRS5URVhUVUFMLCBSZXBhaXJTdHJhdGVneS5ERUZBVUxULCBmYWxzZSk7CiAgICBhZGRUb1N1YnN0aXR1dGlvbnNNYXAocmVzdWx0LCAnX1RPUElDX0xFVkVMX1sxXScsIGRldmljZUlkZW50aWZpZXIpOwoKICAgIC8vVXNlIEM4WSBzb3VyY2VJZAogICAgY29uc3QgZGV2aWNlSWQgPSBuZXcgU3Vic3RpdHV0aW9uVmFsdWUoY3R4LmdldEM4WUlkZW50aWZpZXIoKSwgVFlQRS5URVhUVUFMLCBSZXBhaXJTdHJhdGVneS5ERUZBVUxULCBmYWxzZSk7CiAgICBhZGRUb1N1YnN0aXR1dGlvbnNNYXAocmVzdWx0LCAnZGV2aWNlSWQnLCBkZXZpY2VJZCk7CgogICAgcmV0dXJuIHJlc3VsdDsKfQ==

APP.template.code.shared=Y29uc3QgU3Vic3RpdHV0aW9uUmVzdWx0ID0gSmF2YS50eXBlKCdkeW5hbWljLm1hcHBpbmcucHJvY2Vzc29yLm1vZGVsLlN1YnN0aXR1dGlvblJlc3VsdCcpOwpjb25zdCBTdWJzdGl0dXRpb25WYWx1ZSA9IEphdmEudHlwZSgnZHluYW1pYy5tYXBwaW5nLnByb2Nlc3Nvci5tb2RlbC5TdWJzdGl0dXRlVmFsdWUnKTsKY29uc3QgQXJyYXlMaXN0ID0gSmF2YS50eXBlKCdqYXZhLnV0aWwuQXJyYXlMaXN0Jyk7CmNvbnN0IEhhc2hNYXAgPSBKYXZhLnR5cGUoJ2phdmEudXRpbC5IYXNoTWFwJyk7CmNvbnN0IFRZUEUgPSBKYXZhLnR5cGUoJ2R5bmFtaWMubWFwcGluZy5wcm9jZXNzb3IubW9kZWwuU3Vic3RpdHV0ZVZhbHVlJFRZUEUnKTsKY29uc3QgUmVwYWlyU3RyYXRlZ3kgPSBKYXZhLnR5cGUoJ2R5bmFtaWMubWFwcGluZy5wcm9jZXNzb3IubW9kZWwuUmVwYWlyU3RyYXRlZ3knKTsKCi8vIEhlbHBlciBmdW5jdGlvbiB0byBhZGQgYSBTdWJzdGl0dXRpb25WYWx1ZSB0byB0aGUgbWFwCmZ1bmN0aW9uIGFkZFRvU3Vic3RpdHV0aW9uc01hcChyZXN1bHQsIGtleSwgdmFsdWUpIHsKICAgIGxldCBtYXAgPSByZXN1bHQuZ2V0U3Vic3RpdHV0aW9ucygpOwogICAgbGV0IHZhbHVlc0xpc3QgPSBtYXAuZ2V0KGtleSk7CgogICAgLy8gSWYgdGhlIGxpc3QgZG9lc24ndCBleGlzdCBmb3IgdGhpcyBrZXksIGNyZWF0ZSBpdAogICAgaWYgKHZhbHVlc0xpc3QgPT09IG51bGwgfHwgdmFsdWVzTGlzdCA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgdmFsdWVzTGlzdCA9IG5ldyBBcnJheUxpc3QoKTsKICAgICAgICBtYXAucHV0KGtleSwgdmFsdWVzTGlzdCk7CiAgICB9CgogICAgLy8gQWRkIHRoZSB2YWx1ZSB0byB0aGUgbGlzdAogICAgdmFsdWVzTGlzdC5hZGQodmFsdWUpOwp9