[
  {
    "id": "47121600685",
    "identifier": "l19zjk",
    "name": "Mapping with Filter + Expression",
    "mappingTopic": "/plant1/+/+",
    "mappingTopicSample": "/plant1/line1/dev4711",
    "targetAPI": "MEASUREMENT",
    "direction": "INBOUND",
    "sourceTemplate": "{\"value\":100}",
    "targetTemplate": "{\"measure1_Type\":{\"V\":{\"value\":110,\"unit\":\"C\"}},\"time\":\"2022-08-05T00:14:49.389+02:00\",\"type\":\"c8y_TemperatureMeasurement\"}",
    "mappingType": "JSON",
    "transformationType": "JSONATA",
    "substitutions": [
      {
        "pathSource": "_TOPIC_LEVEL_[1]&\"_\"&_TOPIC_LEVEL_[2]&\"_\"&$substringBefore(_TOPIC_LEVEL_[3],\"_\")",
        "pathTarget": "_IDENTITY_.externalId",
        "repairStrategy": "DEFAULT",
        "expandArray": false
      },
      {
        "pathSource": "$substringAfter(_TOPIC_LEVEL_[3],\"_\")",
        "pathTarget": "type",
        "repairStrategy": "DEFAULT",
        "expandArray": false
      },
      {
        "pathSource": "$now()",
        "pathTarget": "time",
        "repairStrategy": "DEFAULT",
        "expandArray": false
      },
      {
        "pathSource": "value",
        "pathTarget": "measure1_Type.V.value",
        "repairStrategy": "DEFAULT",
        "expandArray": false
      }
    ],
    "active": true,
    "debug": false,
    "createNonExistingDevice": true,
    "updateExistingDevice": false,
    "autoAckOperation": true,
    "useExternalId": true,
    "externalIdType": "c8y_Serial",
    "snoopStatus": "NONE",
    "snoopedTemplates": [],
    "filterMapping": "value > 50",
    "qos": "AT_LEAST_ONCE",
    "lastUpdate": 1744101788851
  },
  {
    "id": "30121604644",
    "identifier": "jrr12x",
    "name": "Mapping with multi values",
    "mappingTopic": "devices/+",
    "mappingTopicSample": "devices/dev4711",
    "targetAPI": "MEASUREMENT",
    "direction": "INBOUND",
    "sourceTemplate": "{\"mea\":[{\"tid\":\"uuid_01\",\"psid\":\"Crest\",\"devicePath\":\"path01_80_X03_VVB001StatusB_Crest\",\"values\":[{\"value\":4.6,\"timestamp\":1744103621000}]},{\"tid\":\"uuid_02\",\"psid\":\"Crest\",\"devicePath\":\"path01_80_X03_VVB001StatusB_Crest\",\"values\":[{\"value\":5.6,\"timestamp\":1744103648000}]}]}",
    "targetTemplate": "{\"c8y_ProcessLoadMeasurement\":{\"L\":{\"value\":110,\"unit\":\"%\"}},\"time\":\"2022-08-05T00:14:49.389+02:00\",\"source\":{\"id\":\"909090\"},\"type\":\"c8y_ProcessLoadMeasurement\"}",
    "mappingType": "JSON",
    "transformationType": "JSONATA",
    "substitutions": [
      {
        "pathSource": "_TOPIC_LEVEL_[1]",
        "pathTarget": "_IDENTITY_.externalId",
        "repairStrategy": "DEFAULT",
        "expandArray": false
      },
      {
        "pathSource": "mea.values[0].value",
        "pathTarget": "c8y_ProcessLoadMeasurement.L.value",
        "repairStrategy": "DEFAULT",
        "expandArray": true
      },
      {
        "pathSource": "$map($map(mea.values[0].timestamp, $number), function($v, $i, $a) { $fromMillis($v) })",
        "pathTarget": "time",
        "repairStrategy": "DEFAULT",
        "expandArray": true
      }
    ],
    "active": false,
    "debug": false,
    "createNonExistingDevice": true,
    "updateExistingDevice": false,
    "autoAckOperation": true,
    "useExternalId": true,
    "externalIdType": "c8y_Serial",
    "snoopStatus": "NONE",
    "snoopedTemplates": [],
    "qos": "AT_LEAST_ONCE",
    "lastUpdate": 1744100522097
  },
  {
    "id": "90121774614",
    "identifier": "73ch32us",
    "name": "Smart Function example",
    "mappingTopic": "device/+/temp",
    "mappingTopicSample": "device/berlin_01/temp",
    "targetAPI": "MEASUREMENT",
    "direction": "INBOUND",
    "sourceTemplate": "{\"Temperature\":{\"value\":110,\"unit\":\"C\"},\"time\":\"2022-08-05T00:14:49.389+02:00\",\"deviceId\":\"909090\"}",
    "targetTemplate": "{\"c8y_TemperatureMeasurement\":{\"T\":{\"value\":110,\"unit\":\"C\"}},\"time\":\"2022-08-05T00:14:49.389+02:00\",\"type\":\"c8y_TemperatureMeasurement\"}",
    "mappingType": "JSON",
    "transformationType": "SMART_FUNCTION",
    "substitutions": [],
    "active": false,
    "debug": false,
    "eventWithAttachment": false,
    "createNonExistingDevice": true,
    "updateExistingDevice": false,
    "autoAckOperation": true,
    "useExternalId": true,
    "externalIdType": "c8y_Serial",
    "snoopStatus": "NONE",
    "snoopedTemplates": [],
    "filterMapping": "",
    "maxFailureCount": 0,
    "qos": "AT_LEAST_ONCE",
    "code": "LyoqCiAqIEBuYW1lIFNtYXJ0IEZ1bmN0aW9uIHNhbXBsZSDigJQgdGVtcGVyYXR1cmUgbW9uaXRvcmluZyB3aXRoIGVucmljaG1lbnQKICogQGRlc2NyaXB0aW9uCiAqICAgRGVtb25zdHJhdGVzIHRoZSBrZXkgU21hcnQgRnVuY3Rpb24gY2FwYWJpbGl0aWVzIGluIG9uZSBleGFtcGxlOgogKiAgIC0gRGV2aWNlIGlkZW50aWZpY2F0aW9uIHZpYSBjbGllbnRJZCBvciBNUVRUIHRvcGljIGxldmVsCiAqICAgLSBJbnZlbnRvcnkgZW5yaWNobWVudDogcmVhZCBkZXZpY2Utc3BlY2lmaWMgdGhyZXNob2xkIGZyb20gbWFuYWdlZCBvYmplY3QKICogICAtIFBlcnNpc3RlbnQgc3RhdGU6IGNvdW50IG1lc3NhZ2VzIGFuZCB0cmFjayBjb25zZWN1dGl2ZSBhbGVydCBzdHJlYWsKICogICAtIENvbmRpdGlvbmFsIG91dHB1dDogYWx3YXlzIGVtaXQgYSBtZWFzdXJlbWVudDsgcmFpc2UgYW4gYWxhcm0gb25seSBvbgogKiAgICAgdGhlIGZpcnN0IGNvbnNlY3V0aXZlIHRocmVzaG9sZCBicmVhY2ggKGF2b2lkcyBkdXBsaWNhdGUgYWxhcm1zKQogKiBAdGVtcGxhdGVUeXBlIElOQk9VTkRfU01BUlRfRlVOQ1RJT04KICogQGRpcmVjdGlvbiBJTkJPVU5ECiAqIEBkZWZhdWx0VGVtcGxhdGUgdHJ1ZQogKiBAaW50ZXJuYWwgdHJ1ZQogKiBAcmVhZG9ubHkgdHJ1ZQogKiBFeHBlY3RlZCBNUVRUIHRvcGljOiAgZGV2aWNlcy97ZXh0ZXJuYWxJZH0vdGVtcGVyYXR1cmUKICogRXhwZWN0ZWQgSlNPTiBwYXlsb2FkOgogKiB7CiAqICAgIlRlbXBlcmF0dXJlIjogeyAidmFsdWUiOiA0NS41LCAidW5pdCI6ICLCsEMiIH0sCiAqICAgImh1bWlkaXR5IjogNjUKICogfQogKgogKiBPcHRpb25hbCBtYW5hZ2VkIG9iamVjdCBmcmFnbWVudCBvbiB0aGUgZGV2aWNlIChjb25maWd1cmVzIHRocmVzaG9sZCk6CiAqIHsKICogICAiYzh5X1RlbXBlcmF0dXJlVGhyZXNob2xkIjogeyAiaGlnaCI6IDQwLjAgfQogKiB9CiAqLwpmdW5jdGlvbiBvbk1lc3NhZ2UobXNnLCBjb250ZXh0KSB7CiAgICB2YXIgcGF5bG9hZCA9IG1zZy5wYXlsb2FkOwoKICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgIC8vIDEuIElkZW50aWZ5IHRoZSBkZXZpY2UKICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgIHZhciBjb25maWcgPSBjb250ZXh0LmdldENvbmZpZygpOwogICAgY29uc29sZS5sb2coIkNvbmZpZyIsIGNvbmZpZyk7CiAgICBjb25zb2xlLmxvZygiUGF5bG9hZCIsIHBheWxvYWQpOwogICAgdmFyIGV4dGVybmFsSWQgPSBjb25maWdbInRvcGljIl0uc3BsaXQoIi8iKVsxXTsKICAgIGlmICghZXh0ZXJuYWxJZCkgewogICAgICAgIGNvbnRleHQuYWRkTG9nTWVzc2FnZSgiQ2Fubm90IGRldGVybWluZSBkZXZpY2UgaWRlbnRpdHkg4oCUIG1lc3NhZ2UgZHJvcHBlZCIpOwogICAgICAgIHJldHVybiBbXTsKICAgIH0KCiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAvLyAyLiBWYWxpZGF0ZSByZXF1aXJlZCBwYXlsb2FkIGZpZWxkcyBlYXJseQogICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgdmFyIHRlbXBEYXRhID0gcGF5bG9hZFsiVGVtcGVyYXR1cmUiXTsKICAgIGlmICghdGVtcERhdGEgfHwgdGVtcERhdGFbInZhbHVlIl0gPT09IHVuZGVmaW5lZCkgewogICAgICAgIGNvbnRleHQuYWRkTG9nTWVzc2FnZSgiTWlzc2luZyAnVGVtcGVyYXR1cmUnIGluIHBheWxvYWQgZm9yIGRldmljZTogIiArIGV4dGVybmFsSWQpOwogICAgICAgIHJldHVybiBbXTsKICAgIH0KICAgIHZhciB0ZW1wZXJhdHVyZSA9IHRlbXBEYXRhWyJ2YWx1ZSJdOwogICAgdmFyIHVuaXQgICAgICAgID0gdGVtcERhdGFbInVuaXQiXSB8fCAiwrBDIjsKCiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAvLyAzLiBFbnJpY2ggZnJvbSBpbnZlbnRvcnk6IGxvb2sgdXAgZGV2aWNlLXNwZWNpZmljIGFsZXJ0IHRocmVzaG9sZC4KICAgIC8vICAgIGdldE1hbmFnZWRPYmplY3RCeUV4dGVybmFsSWQgcmV0dXJucyB0aGUgZnVsbCBtYW5hZ2VkIG9iamVjdCBvcgogICAgLy8gICAgbnVsbCB3aGVuIHRoZSBkZXZpY2UgaGFzIG5vdCBiZWVuIHJlZ2lzdGVyZWQgaW4gaW52ZW50b3J5IHlldC4KICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgIHZhciB0aHJlc2hvbGQgPSA0MC4wOyAvLyBzZW5zaWJsZSBkZWZhdWx0CiAgICB2YXIgZGV2aWNlID0gY29udGV4dC5nZXRNYW5hZ2VkT2JqZWN0QnlFeHRlcm5hbElkKHsgZXh0ZXJuYWxJZDogZXh0ZXJuYWxJZCwgdHlwZTogImM4eV9TZXJpYWwiIH0pOwogICAgaWYgKGRldmljZSkgewogICAgICAgIHZhciB0aHJlc2hvbGRDZmcgPSBkZXZpY2VbImM4eV9UZW1wZXJhdHVyZVRocmVzaG9sZCJdOwogICAgICAgIGlmICh0aHJlc2hvbGRDZmcgJiYgdGhyZXNob2xkQ2ZnWyJoaWdoIl0gIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICB0aHJlc2hvbGQgPSB0aHJlc2hvbGRDZmdbImhpZ2giXTsKICAgICAgICAgICAgY29uc29sZS5sb2coIlVzaW5nIGRldmljZSB0aHJlc2hvbGQ6ICIgKyB0aHJlc2hvbGQgKyB1bml0KTsKICAgICAgICB9CiAgICB9IGVsc2UgewogICAgICAgIGNvbnRleHQuYWRkTG9nTWVzc2FnZSgiRGV2aWNlIG5vdCB5ZXQgaW4gaW52ZW50b3J5LCB1c2luZyBkZWZhdWx0IHRocmVzaG9sZCAiICsgdGhyZXNob2xkICsgdW5pdCk7CiAgICB9CgogICAgdmFyIGV4Y2VlZGVkICAgID0gdGVtcGVyYXR1cmUgPiB0aHJlc2hvbGQ7CgogICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgLy8gNC4gQnVpbGQgb3V0cHV0IG9iamVjdHMKICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgIHZhciByZXN1bHRzID0gW107CgogICAgLy8gNGEuIEFsd2F5cyBlbWl0IGEgdGVtcGVyYXR1cmUgbWVhc3VyZW1lbnQKICAgIHJlc3VsdHMucHVzaCh7CiAgICAgICAgY3VtdWxvY2l0eVR5cGU6ICJtZWFzdXJlbWVudCIsCiAgICAgICAgYWN0aW9uOiAiY3JlYXRlIiwKICAgICAgICBwYXlsb2FkOiB7CiAgICAgICAgICAgIHRpbWU6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSwKICAgICAgICAgICAgdHlwZTogImM4eV9UZW1wZXJhdHVyZU1lYXN1cmVtZW50IiwKICAgICAgICAgICAgYzh5X1RlbXBlcmF0dXJlTWVhc3VyZW1lbnQ6IHsKICAgICAgICAgICAgICAgIFQ6IHsgdmFsdWU6IHRlbXBlcmF0dXJlLCB1bml0OiB1bml0IH0KICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgZXh0ZXJuYWxTb3VyY2U6IFt7IHR5cGU6ICJjOHlfU2VyaWFsIiwgZXh0ZXJuYWxJZDogZXh0ZXJuYWxJZCB9XQogICAgfSk7CgogICAgLy8gNGIuIFJhaXNlIGFuIGFsYXJtCiAgICBpZiAoZXhjZWVkZWQpIHsKICAgICAgICBjb250ZXh0LmFkZExvZ01lc3NhZ2UoCiAgICAgICAgICAgICJUaHJlc2hvbGQgYnJlYWNoIG9uICIgKyBleHRlcm5hbElkICsKICAgICAgICAgICAgIjogIiArIHRlbXBlcmF0dXJlICsgdW5pdCArICIgPiAiICsgdGhyZXNob2xkICsgdW5pdAogICAgICAgICk7CiAgICAgICAgcmVzdWx0cy5wdXNoKHsKICAgICAgICAgICAgY3VtdWxvY2l0eVR5cGU6ICJhbGFybSIsCiAgICAgICAgICAgIGFjdGlvbjogImNyZWF0ZSIsCiAgICAgICAgICAgIHBheWxvYWQ6IHsKICAgICAgICAgICAgICAgIHRpbWU6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSwKICAgICAgICAgICAgICAgIHR5cGU6ICJjOHlfVGVtcGVyYXR1cmVUaHJlc2hvbGRBbGFybSIsCiAgICAgICAgICAgICAgICB0ZXh0OiAiVGVtcGVyYXR1cmUgIiArIHRlbXBlcmF0dXJlICsgdW5pdCArCiAgICAgICAgICAgICAgICAgICAgICAiIGV4Y2VlZHMgdGhyZXNob2xkIG9mICIgKyB0aHJlc2hvbGQgKyB1bml0LAogICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJNQUpPUiIsCiAgICAgICAgICAgICAgICBzdGF0dXM6ICJBQ1RJVkUiCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGV4dGVybmFsU291cmNlOiBbeyB0eXBlOiAiYzh5X1NlcmlhbCIsIGV4dGVybmFsSWQ6IGV4dGVybmFsSWQgfV0KICAgICAgICB9KTsKICAgIH0KCiAgICByZXR1cm4gcmVzdWx0czsKfQo=",
    "lastUpdate": 1759917840151
  }
]